{% include 'header_lk_template.html' %}
<div class="page-header">
    <h2>üè¶ –ë–∞–Ω–∫ –∑–∞–¥–∞–Ω–∏–π</h2>
    <p class="text-muted">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–¥–∞—á–∏ –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</p>
</div>

<div class="filter-section card-glass">
    <form method="GET" action="{{ url_for('choose_task') }}" class="filter-form">
        <div class="filter-group">
            <label>–ü—Ä–µ–¥–º–µ—Ç</label>
            <div class="select-wrapper">
                <select name="subject" class="modern-select">
                    {% for item in subjects %}
                    <option value="{{ item }}" {% if subject==item %}selected{% endif %}>
                        {{ item if item != "" else "–í—Å–µ –ø—Ä–µ–¥–º–µ—Ç—ã" }}
                    </option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="filter-group">
            <label>–°–ª–æ–∂–Ω–æ—Å—Ç—å</label>
            <div class="select-wrapper">
                <select name="complexity" class="modern-select">
                    <option value="">–õ—é–±–∞—è</option>
                    <option value="–õ–µ–≥–∫–∞—è" {% if complexity=="–õ–µ–≥–∫–∞—è" %}selected{% endif %}>üü¢ –õ–µ–≥–∫–∞—è</option>
                    <option value="–°—Ä–µ–¥–Ω—è—è" {% if complexity=="–°—Ä–µ–¥–Ω—è—è" %}selected{% endif %}>üü° –°—Ä–µ–¥–Ω—è—è</option>
                    <option value="–°–ª–æ–∂–Ω–∞—è" {% if complexity=="–°–ª–æ–∂–Ω–∞—è" %}selected{% endif %}>üî¥ –°–ª–æ–∂–Ω–∞—è</option>
                </select>
            </div>
        </div>

        <div class="filter-group">
            <label>–¢–µ–º–∞</label>
            <div class="select-wrapper">
                <select name="theme" class="modern-select">
                    <option value="">–í—Å–µ —Ç–µ–º—ã</option>
                    <option value="–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è">üìê –ö–≤. —É—Ä–∞–≤–Ω–µ–Ω–∏—è</option>
                    <option value="–¢–µ—Ä–º–æ–¥–∏–Ω–∞–º–∏–∫–∞">üå°Ô∏è –¢–µ—Ä–º–æ–¥–∏–Ω–∞–º–∏–∫–∞</option>
                </select>
            </div>
        </div>

        <button type="submit" class="btn-apply">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
    </form>
</div>

<div class="tasks-container">
    {% if tasklist %}
    <h3 class="section-title">‚ú® –ù–æ–≤—ã–µ –∑–∞–¥–∞—á–∏</h3>
    <div class="task-grid">
        {% for task in tasklist %}
        <a href="{{ url_for('solve_task', taskid=task['id']) }}" class="task-card-modern">
            <div class="task-header">
                <span class="task-id">#{{ task['name'] }}</span>
                <span
                    class="badge badge-{{ 'success' if task['complexity'] == '–õ–µ–≥–∫–∞—è' else 'warning' if task['complexity'] == '–°—Ä–µ–¥–Ω—è—è' else 'danger' }}">{{
                    task['complexity'] }}</span>
            </div>
            <h4 class="task-title">{{ task['theme'] }}</h4>
            <div class="task-footer">
                <span class="task-subject">üìö {{ task['subject'] }}</span>
                <span class="task-arrow">‚Üí</span>
            </div>
        </a>
        {% endfor %}
    </div>
    {% endif %}

    {% if unsolved %}
    <h3 class="section-title">‚ö†Ô∏è –¢—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è</h3>
    <div class="task-grid">
        {% for task in unsolved %}
        <a href="{{ url_for('solve_task', taskid=task['id']) }}" class="task-card-modern task-unsolved">
            <div class="task-header">
                <span class="task-id">#{{ task['name'] }}</span>
                <span class="badge badge-danger">–û—à–∏–±–∫–∞</span>
            </div>
            <h4 class="task-title">{{ task['theme'] }}</h4>
            <div class="task-footer">
                <span class="task-subject">{{ task['subject'] }}</span>
                <span class="task-status">–†–µ—à–µ–Ω–æ –Ω–µ–≤–µ—Ä–Ω–æ</span>
            </div>
        </a>
        {% endfor %}
    </div>
    {% endif %}

    {% if solved %}
    <h3 class="section-title">‚úÖ –†–µ—à–µ–Ω–Ω—ã–µ</h3>
    <div class="task-grid">
        {% for task in solved %}
        <a href="{{ url_for('solve_task', taskid=task['id']) }}" class="task-card-modern task-solved">
            <div class="task-header">
                <span class="task-id">#{{ task['name'] }}</span>
                <span class="badge badge-success">–†–µ—à–µ–Ω–æ</span>
            </div>
            <h4 class="task-title">{{ task['theme'] }}</h4>
            <div class="task-footer">
                <span class="task-subject">{{ task['subject'] }}</span>
                <span class="task-status">–û—Ç–ª–∏—á–Ω–æ!</span>
            </div>
        </a>
        {% endfor %}
    </div>
    {% endif %}

    {% if not tasklist and not unsolved and not solved %}
    <div class="empty-state">
        <div class="empty-icon">üìÇ</div>
        <h3>–ó–∞–¥–∞—á–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</p>
    </div>
    {% endif %}
</div>
<script>
    socket.on('message', function (data) {
        console.log(data)
        if (['update_task', 'post_new_task'].includes(data)) {
            console.log('True')
            location.reload();
        } else {
            console.log('False')
        }
        //location.reload(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
    });
</script>
{% include 'footer_lk_template.html' %}