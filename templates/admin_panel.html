{% include 'header_lk_template.html' %}

<link rel="stylesheet" href="/static/css/components.css">

<section class="dashboard-card">
    <h2>Добавить пользователя</h2>

    <form action="{{ url_for('admin_add_user') }}" method="POST" style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
        <input class="small-input" type="text" name="username" placeholder="Никнейм" required style="min-width:160px;">
        <input class="small-input" type="email" name="email" placeholder="Email" required style="min-width:200px;">
        <input class="small-input" type="password" name="password" placeholder="Пароль" required style="min-width:160px;">
        <label style="display:flex; align-items:center; gap:6px;"><input type="checkbox" name="is_admin"> Администратор</label>
        <button type="submit" class="btn btn-primary">Добавить</button>
    </form>
</section>

<section class="dashboard-card">
    <h2>Список пользователей</h2>

    <div style="overflow-x:auto; margin-top: 20px;">
        <table style="width:100%; border-collapse:collapse; background:white; border-radius:8px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,0.06);">
            <thead>
                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                    <th style="padding:12px; text-align:left; font-weight:600;">ID</th>
                    <th style="padding:12px; text-align:left; font-weight:600;">Ник</th>
                    <th style="padding:12px; text-align:left; font-weight:600;">Email</th>
                    <th style="padding:12px; text-align:left; font-weight:600;">Admin</th>
                    <th style="padding:12px; text-align:left; font-weight:600;">Team</th>
                    <th style="padding:12px; text-align:center; font-weight:600;">Действия</th>
                </tr>
            </thead>
            <tbody>
                {% if users %}
                {% for u in users %}
                <tr style="border-bottom:1px solid #f0f0f0;">
                    <td style="padding:12px; font-weight:600; color:#333;">{{ u[0] }}</td>
                    <td style="padding:12px; color:#333;">{{ u[1] }}</td>
                    <td style="padding:12px; color:#666;">{{ u[2] }}</td>
                    <td style="padding:12px; color:#333;">{{ 'Да' if u[3] else 'Нет' }}</td>
                    <td style="padding:12px; color:#333;">{{ u[4] if u[4] else '-' }}</td>
                    <td style="padding:12px; text-align:center;">
                        <div style="display:flex; gap:8px; flex-wrap:wrap; justify-content:center;">
                            <form action="{{ url_for('admin_delete_user') }}" method="POST" style="display:inline;">
                                <input type="hidden" name="userid" value="{{ u[0] }}">
                                <button class="btn" style="background:#efefef; padding:8px 12px; border-radius:6px;">Удалить</button>
                            </form>


                            <form action="{{ url_for('admin_change_nickname') }}" method="POST" style="display:inline;">
                                <input type="hidden" name="userid" value="{{ u[0] }}">
                                <input class="users-table-input" type="text" name="new_nick" placeholder="Новый ник">
                                <button class="btn btn-ghost">Изменить</button>
                            </form>

                            <form action="{{ url_for('admin_change_password') }}" method="POST" style="display:inline;">
                                <input type="hidden" name="userid" value="{{ u[0] }}">
                                <input class="users-table-input" type="password" name="new_password" placeholder="Новый пароль">
                                <button class="btn btn-ghost">Сменить пароль</button>
                            </form>

                            <form action="{{ url_for('admin_upload_avatar') }}" method="POST" enctype="multipart/form-data" style="display:inline;">
                                <input type="hidden" name="userid" value="{{ u[0] }}">
                                <input type="file" name="file" accept="image/*">
                                <button class="btn btn-ghost">Загрузить аватар</button>
                            </form>
                        </div>
                    </td>
                </tr>
                {% endfor %}
                {% else %}
                <tr>
                    <td colspan="6" style="padding:30px; text-align:center; color:#999;">Нет пользователей</td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</section>

{% include 'footer_lk_template.html' %}