{% include 'header_lk_template.html' %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/components.css') }}">

{% if session.adm %}
<section class="dashboard-card">
    <h2>üìö –ë–∞–Ω–∫ –∑–∞–¥–∞–Ω–∏–π</h2>
    <p style="color: #666; margin-bottom: 30px;">–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤–∞—à–∏–º–∏ –∑–∞–¥–∞–Ω–∏—è–º–∏</p>
    
    <div class="task-list">
        {% for task in tasklist %}
        <div class="task-card">
            <h3>{{ task['name'] }}</h3>
            <p>ID: <strong>#{{ task['id'] }}</strong></p>
            <div class="task-meta">
                <div class="task-meta-item">
                    üìÖ <strong>{{ task.get('created', 'N/A') }}</strong>
                </div>
            </div>
            <div style="margin-top: 20px; display: flex; gap: 10px;">
                <a href="{{ url_for('task', taskid=task['id']) }}" style="flex: 1;">
                    <button class="btn btn-gold" style="width: 100%;">–ü—Ä–æ—Å–º–æ—Ç—Ä</button>
                </a>
                <a href="{{ url_for('download', taskid=task['id']) }}" style="flex: 1;">
                    <button class="btn btn-outline" style="width: 100%; color: #1a2a6c; border-color: #1a2a6c;">–°–∫–∞—á–∞—Ç—å</button>
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <div style="margin-top: 40px;">
        <a href="{{ url_for('new_task') }}">
            <button class="btn btn-gold" style="font-size: 1.1rem;">‚ú® –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ</button>
        </a>
    </div>
</section>
{% endif %}

<script>
    var socket = io();
    socket.on('message', function(data) {
        console.log('–°–æ–±—ã—Ç–∏–µ: ' + data)
        if (['update_task', 'post_new_task'].includes(data)) {
            console.log('–û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É...')
            location.reload();
        }
    });
</script>

{% include 'footer_lk_template.html' %}